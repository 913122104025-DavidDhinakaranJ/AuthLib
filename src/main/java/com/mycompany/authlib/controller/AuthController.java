package com.mycompany.authlib.controller;import com.mycompany.authlib.exceptions.IncorrectPasswordException;import com.mycompany.authlib.exceptions.UserAlreadyExistException;import com.mycompany.authlib.exceptions.UserNotFoundException;import com.mycompany.authlib.users.AuthenticatableUser;import com.mycompany.authlib.users.factory.AuthenticatableUserFactory;import com.mycompany.authlib.repositories.IAuthenticatableUserRepository;public class AuthController implements IAuthController {    private final IAuthenticatableUserRepository users;    private final AuthenticatableUserFactory factory;    public AuthController(IAuthenticatableUserRepository userRepository, AuthenticatableUserFactory factory) {        this.users = userRepository;        this.factory = factory;    }        @Override    public AuthenticatableUser handleRegistration(String username, String password) throws UserAlreadyExistException {        if(users.isUsernameTaken(username)) {            throw new UserAlreadyExistException();        }                AuthenticatableUser newUser = factory.createUser(username, password);        users.saveUser(newUser);                return newUser;    }    @Override    public AuthenticatableUser handleLogin(String username, String password) throws UserNotFoundException, IncorrectPasswordException {        AuthenticatableUser user = users.findUser(username);        if(user == null) {            throw new UserNotFoundException();        } else if(!user.validatePassword(password)) {            throw new IncorrectPasswordException();        }         return user;    }    @Override    public void changePassword(AuthenticatableUser user, String oldPassword, String newPassword) throws IncorrectPasswordException {        if(!user.validatePassword(oldPassword)) {            throw new IncorrectPasswordException();        }                user.changePassword(newPassword);        users.saveUser(user);    }}